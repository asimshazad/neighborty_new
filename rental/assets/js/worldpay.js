/* WorldpayJS v0.19.0 - Tue, 08 Sep 2015 11:45:17 GMT */
!function(w){var Worldpay=Worldpay||{api_path:"https://api.worldpay.com/v1/",templates_path:"https://online.worldpay.com/templates/",clientKey:"",templateCode:!1,token:"",reusable:!1,cvc:!0,timeout:10,currencyCode:"EUR",validationType:"advanced",templateSaveButton:!0,templateOptions:{addedText:"Payment details added",addedTextCVC:"CVC added",enterCardDetailsButton:"Enter card details",iframeOverlay:'position: absolute;top: 0px;bottom: 0px;left: 0px;right: 0px;background-color: #000;-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=80)";filter: alpha(opacity=80);-moz-opacity: 0.8;-khtml-opacity: 0.8;opacity: 0.8;',iframeClose:"position: absolute;top: 100px;height: 20px;width: 20px;right: -350px;text-decoration: none;margin-right: 50%;cursor: pointer;z-index: 999;color: #000;font-size: 16px;font-weight: bold;text-align: center;",iframeHolderInline:"position: relative;top: 0px;background-color: #fff;border:none;",iframeHolderModal:"position: absolute;top: 100px;left: -350px;background-color: #fff;width: 220px;height: 220px;margin-left: 50%;border:none;",dimensions:{width:!1,height:!1},images:{enabled:!0}},displayType:"ownForm",templateType:"card",invalidClientKey:!1,tokenType:"card"};Worldpay.setClientKey=function(a){this.clientKey=a},Worldpay.setTemplate=function(a){this.templateCode=a},Worldpay.setReusable=function(a){this.reusable=!!a},Worldpay.setCVC=function(a){this.cvc=!!a},Worldpay.setTemplateOptions=function(a){a.addedText&&(Worldpay.templateOptions.addedText=a.addedText),a.addedTextCVC&&(Worldpay.templateOptions.addedTextCVC=a.addedTextCVC),a.enterCardDetailsButton&&(Worldpay.templateOptions.enterCardDetailsButton=a.enterCardDetailsButton),a.iframeOverlay&&(Worldpay.templateOptions.iframeOverlay=a.iframeOverlay),a.iframeHolderInline&&(Worldpay.templateOptions.iframeHolderInline=a.iframeHolderInline),a.iframeHolderModal&&(Worldpay.templateOptions.iframeHolderModal=a.iframeHolderModal),a.dimensions&&(Worldpay.templateOptions.dimensions=a.dimensions),a.dimensions&&(Worldpay.templateOptions.dimensions=a.dimensions),a.images&&(Worldpay.templateOptions.images=a.images)},Worldpay.setValidationType=function(a){this.validationType="basic"==a||"advanced"==a?a:"advanced"},Worldpay.useOwnForm=function(a){var b=!1,c=!1,d=!1,e=!1;return a.form&&(b=Worldpay.helpers.getElement(a.form,"FORM")),a.callback&&(c=a.callback),a.useReusableToken&&(d=a.useReusableToken),a.clientKey&&Worldpay.setClientKey(a.clientKey),a.reusable&&Worldpay.setReusable(!!a.reusable),a.cvc&&(e=a.cvc,Worldpay.templateType="cvc"),Worldpay.clientKey?b===!1?(console.log("WorldpayJS: No form found- f04"),!1):"function"!=typeof c?(console.log("WorldpayJS: No callback found - c04"),!1):void(b.onsubmit=function(){var a=document.getElementById("payment-form");window.Placeholders&&a&&(window.Placeholders.disable(a),setTimeout(function(){window.Placeholders.enable(a)},50));for(var f=0;f<b.length;f++)("button"===b[f].type||"submit"===b[f].type)&&("modal"!=Worldpay.displayType?0==Worldpay.templateSaveButton&&(b[f].disabled="disabled"):0==Worldpay.templateSaveButton&&(b[f].disabled="disabled"));return("inline"==Worldpay.displayType||"modal"==Worldpay.displayType)&&(c=function(a,c){Worldpay.helpers.templateFormCallback(a,c,b)}),"apm"===Worldpay.tokenType?(Worldpay.apm.createToken(b,c),!1):(0!=e?Worldpay.card.updateToken(b,e,c):void 0==d||0==d?Worldpay.card.createToken(b,c):Worldpay.card.reuseToken(b,c),!1)}):(console.log("WorldpayJS: No clientKey found - clk04"),!1)},Worldpay.useForm=function(a,b,c){Worldpay.useOwnForm({form:a,callback:b,useReusableToken:c})},Worldpay.useTemplateForm=function(a){var b=!1,c=!1,d=!1,e=!1,f=!1,g=(Worldpay.templateSaveButton,!1);if(a.form&&(b=Worldpay.helpers.getElement(a.form,"FORM")),a.paymentSection&&(c=Worldpay.helpers.getElement(a.paymentSection)),a.display&&(d=a.display),a.type&&(e=a.type),a.callback&&(f=a.callback),a.clientKey&&Worldpay.setClientKey(a.clientKey),a.reusable&&Worldpay.setReusable(!!a.reusable),void 0!=a.saveButton&&(Worldpay.templateSaveButton=!!a.saveButton),a.templateOptions&&Worldpay.setTemplateOptions(a.templateOptions),a.code&&(Worldpay.templateCode=a.code),a.token)g=a.token,Worldpay.cvcToken=g;else if("cvc"==e)return console.log("WorldpayJS: No token defined for CVC type - cvctkn04"),!1;if(!Worldpay.clientKey)return console.log("WorldpayJS: No clientKey found - clk04"),!1;if(b===!1&&"function"!=typeof f)return console.log("WorldpayJS: No form or callback found - fc04"),!1;if(c===!1)return console.log("WorldpayJS: No payment section found - psn04"),!1;if(d===!1)return console.log("WorldpayJS: No display set - t04"),!1;Worldpay.displayType=d="inline"==d||"modal"==d?d:"modal",Worldpay.templateType=e="card"==e||"cvc"==e?e:"card",b!==!1&&b.setAttribute("onsubmit","return Worldpay.checkTemplateForm(this)"),"modal"==d?(c.innerHTML="<div id='token_container'>                                          <input type='button' value='"+Worldpay.templateOptions.enterCardDetailsButton+"' id='token_container-button' />                                          <div id='token_container_holder' style='visibility:hidden'></div>                                        </div>",document.getElementById("token_container-button").setAttribute("onclick","Worldpay.getTemplateToken()")):"inline"==d&&(c.innerHTML="<div id='token_container'>                                  <div id='token_container_holder' style='visibility:hidden'></div>                                </div>",Worldpay.getTemplateToken());var h=function(a){a=a||window.event;var c=Worldpay.helpers.JSON.parse(a.data);Worldpay._dimensions=Worldpay._dimensions||{width:220,height:220};var d=Worldpay._dimensions;if(void 0!=c.token){var e=document.getElementById("token_container");void 0!=f&&0!=f?(f(c),b!==!1&&b.setAttribute("onsubmit","")):e.innerHTML="<div class='token_data_div'><input type='hidden' id='worldpayjs_token' name='token' value='"+c.token+"' />"+Worldpay.templateOptions.addedText+"</div>",0==Worldpay.templateSaveButton&&b!==!1&&b.submit()}else if(void 0!=c.cvc){var e=document.getElementById("token_container");void 0!=f&&0!=f?(f(c),b!==!1&&b.setAttribute("onsubmit","")):e.innerHTML="",0==Worldpay.templateSaveButton&&b!==!1&&b.submit()}else if(void 0!=c.dimensions)Worldpay.templateOptions.dimensions.width?d.width=Worldpay.templateOptions.dimensions.width:c.dimensions.width&&(d.width=c.dimensions.width),Worldpay.templateOptions.dimensions.height?d.height=Worldpay.templateOptions.dimensions.height:c.dimensions.height&&(d.height=c.dimensions.height);else if(void 0!=c.visibility){var g=document.getElementById("token_container_holder"),h=200;if(!g)return;if(g.style.opacity=0,g.style.filter="alpha(opacity=0)",g.style.display="inline-block",g.style.visibility="visible",h)var i=0,j=setInterval(function(){i+=50/h,i>=1&&(clearInterval(j),i=1),g.style.opacity=i,g.style.filter="alpha(opacity="+100*i+")"},50);else g.style.opacity=1,g.style.filter="alpha(opacity=1)"}document.getElementById("_iframe_holder")&&document.getElementById("_iframe_holder").style&&(Worldpay.templateOptions.dimensions.width&&(d.width=Worldpay.templateOptions.dimensions.width.toString().replace("px",""),document.getElementById("_iframe_holder").style.width=d.width+"px"),Worldpay.templateOptions.dimensions.height&&(d.height=Worldpay.templateOptions.dimensions.height.toString().replace("px",""),document.getElementById("_iframe_holder").style.height=d.height+"px"),document.getElementById("_iframe_holder").style.width=d.width.toString().replace("px","")+"px",document.getElementById("_iframe_holder").style.height=d.height.toString().replace("px","")+"px",null!=document.getElementById("_iframe_close")&&(document.getElementById("_iframe_holder").style.left=-(d.width.toString().replace("px","")/2)+"px",document.getElementById("_iframe_close").style.right=-(d.width.toString().replace("px","")/2)+"px"))};window.addEventListener?window.addEventListener("message",h,!1):window.attachEvent("onmessage",h,!1)},Worldpay.useTemplate=function(a,b,c,d){Worldpay.useTemplateForm({form:a,paymentSection:b,display:c,callback:d})},Worldpay.submitTemplateForm=function(){var a=document.getElementById("_iframe_holder"),b=a.contentWindow||a.contentDocument;b.postMessage(Worldpay.helpers.JSON.stringify({submit:!0}),"*")},Worldpay.getTemplateToken=function(){if("modal"==Worldpay.displayType){var a=document.getElementById("token_container_holder");a.innerHTML="<div id='_iframe_overlay' style='"+Worldpay.templateOptions.iframeOverlay+"'></div>                                              <a id='_iframe_close' onclick='Worldpay.closeTemplateModal()' href='javascript:;' style='"+Worldpay.templateOptions.iframeClose+"'>&times;</a>                                              <iframe id='_iframe_holder' scrolling='no' style='"+Worldpay.templateOptions.iframeHolderModal+"' marginheight='0' marginwidth='0' frameborder='0'></iframe>";var b=setInterval(function(){document.getElementById("_iframe_overlay").style.webkitTransform="scale(0.9999999)"},1),c=setInterval(function(){document.getElementById("_iframe_overlay").style.webkitTransform="scale(1)"},5);setTimeout(function(){clearInterval(b),clearInterval(c)},5e3)}else if("inline"==Worldpay.displayType){var a=document.getElementById("token_container_holder");a.innerHTML="<iframe id='_iframe_holder' scrolling='no' style='"+Worldpay.templateOptions.iframeHolderInline+"' marginheight='0' marginwidth='0' frameborder='0'></iframe>"}var d=Worldpay.templates_path,e=document.getElementById("_iframe_holder"),f=e.contentWindow||e.contentDocument;f.document&&(f=f.document),"modal"==Worldpay.displayType?f.write('<body><form action="'+d+'" method="POST" id="iframepost"><input type="hidden" name="clientKey" value="'+Worldpay.clientKey+'" /><input type="hidden" name="templateType" value="'+Worldpay.templateType+'" /><input type="hidden" name="cvc" value="'+Worldpay.cvc+'" /><input type="hidden" name="reusable" value="'+Worldpay.reusable+'" /><input type="hidden" name="cvcToken" value="'+(Worldpay.cvcToken||!1)+'" /><input type="hidden" name="displayType" value="modal" /><input type="hidden" name="button" value="Save" /><input type="hidden" name="templateCode" value="'+(Worldpay.templateCode||0)+'" /><input type="hidden" name="images" value="'+Worldpay.templateOptions.images.enabled+'" /></form></body>'):"inline"==Worldpay.displayType&&f.write('<body><form action="'+d+'" method="POST" id="iframepost"><input type="hidden" name="clientKey" value="'+Worldpay.clientKey+'" /><input type="hidden" name="templateType" value="'+Worldpay.templateType+'" /><input type="hidden" name="cvc" value="'+Worldpay.cvc+'" /><input type="hidden" name="reusable" value="'+Worldpay.reusable+'" /><input type="hidden" name="cvcToken" value="'+(Worldpay.cvcToken||!1)+'" /><input type="hidden" name="displayType" value="inline" /><input type="hidden" name="button" value="Save" /><input type="hidden" name="templateCode" value="'+(Worldpay.templateCode||0)+'" /><input type="hidden" name="templateSaveButton" value="'+Worldpay.templateSaveButton+'" /><input type="hidden" name="templateDimensions" value="'+(0!=Worldpay.templateOptions.dimensions.width||0!=Worldpay.templateOptions.dimensions.height?"w:"+Worldpay.templateOptions.dimensions.width+",h:"+Worldpay.templateOptions.dimensions.height:"")+'" /><input type="hidden" name="images" value="'+Worldpay.templateOptions.images.enabled+'" /></form></body>'),f.getElementById("iframepost").submit()},Worldpay.closeTemplateModal=function(){var a=document.getElementById("token_container_holder"),b=300;if(a)if(b)var c=1,d=setInterval(function(){c-=50/b,0>=c&&(clearInterval(d),c=0,a.style.display="none",a.style.visibility="hidden"),a.style.opacity=c,a.style.filter="alpha(opacity="+100*c+")"},50);else a.style.opacity=0,a.style.filter="alpha(opacity=0)",a.style.display="none",a.style.visibility="hidden"},Worldpay.checkTemplateForm=function(a){return void 0!=a.token?!0:!1},Worldpay.handleError=function(a,b,c){if(!b)return!1;if(c.message&&(c=c.message),void 0!=c){"string"==typeof c?b.innerHTML=Worldpay.helpers.capitaliseFirstLetter(c):"object"==typeof c&&(b.innerHTML=c.join("<br/>"));for(var d=0;d<a.length;d++)("button"===a[d].type||"submit"===a[d].type)&&(a[d].disabled=!1)}},Worldpay.formBuilder=function(a,b,c,d,e,f){var g=document.createElement(b);g.type=c,g.name=d,g.id=f||d,g.value=e,a.appendChild(g)},Worldpay.helpers={},Worldpay.helpers.getElement=function(a,b){if(""!=a&&void 0!=a){if(a&&a.tagName&&(!b||b&&a.tagName==b))return a;var c=document.getElementById(a);if(c&&c.tagName&&(!b||b&&c.tagName==b))return a=document.getElementById(a);if(a[0]&&a[0].tagName&&(!b||b&&a[0].tagName==b))return a[0]}return!1},Worldpay.helpers.deleteFunction=function(a){try{delete w[a]}catch(b){w[a]=void 0}},Worldpay.helpers.getEl=function(a){return"string"==typeof a&&(a=document.getElementById(a)),a},Worldpay.helpers.collect=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=b(a[d]);null!==e&&c.push(e)}return c},Worldpay.helpers.createErrorResponse=function(a){var b={error:{message:"",object:[]}};if(a.length){b.error.object=a;for(var c=[],d=0;d<a.length;d++)for(var e in a[d])c.push(a[d][e]);c.join("<br/>"),b.error.message=c}return b},Worldpay.helpers.templateFormCallback=function(a,b,c){if(document.getElementById("_el_error_nameoncard")&&(document.getElementById("_el_error_nameoncard").style.display="none"),document.getElementById("_el_error_cardnumber")&&(document.getElementById("_el_error_cardnumber").style.display="none"),document.getElementById("_el_error_expiration")&&(document.getElementById("_el_error_expiration").style.display="none"),document.getElementById("_el_error_cvc")&&(document.getElementById("_el_error_cvc").style.display="none"),document.getElementById("payment-errors")&&(document.getElementById("payment-errors").style.display="none"),b.error){if("BAD_REQUEST"==b.error.customCode)Worldpay.handleError(c,document.getElementById("payment-errors"),b.error.message),document.getElementById("_el_error_cvc").style.display="block";else if(b.error.object)for(var d in b.error.object)for(var e in b.error.object[d])"nameoncard"==e?document.getElementById("_el_error_nameoncard").style.display="block":"cardnumber"==e?document.getElementById("_el_error_cardnumber").style.display="block":"expiration"==e?document.getElementById("_el_error_expiration").style.display="block":"cvc"==e?document.getElementById("_el_error_cvc").style.display="block":"other"==e&&(document.getElementById("payment-errors").style.display="block",document.getElementById("payment-errors").innerHTML=b.error.object[d].other)}else if(b.token){var f=b.token;Worldpay.formBuilder(c,"input","hidden","token",f),window.parent.postMessage(Worldpay.helpers.JSON.stringify(b),"*")}else"cvc"==Worldpay.templateType&&window.parent.postMessage(Worldpay.helpers.JSON.stringify({cvc:!0,status:a,response:b}),"*")},Worldpay.helpers.capitaliseFirstLetter=function(a){return a?a.charAt(0).toUpperCase()+a.slice(1):""},Worldpay.helpers.ajax={},Worldpay.helpers.ajax.x=function(a,b){var c=new XMLHttpRequest;return"withCredentials"in c?c.open(a,b,!0):"undefined"!=typeof XDomainRequest?(c=new XDomainRequest,c.open(a,b)):c=null,c},Worldpay.helpers.ajax.send=function(a,b,c,d){try{if(window.XMLHttpRequest){var e=new XMLHttpRequest;if("withCredentials"in e)e.onreadystatechange=function(){if(e.readyState&&4===e.readyState){var a=e.responseText?e.responseText:"{}";try{var d=Worldpay.helpers.JSON.parse(a),f=d.customCode&&""!=d.customCode?{error:{message:d.message,customCode:d.customCode}}:d,g=200;d.token||(g="PUT"==c.toUpperCase()?e.status&&0!=parseInt(e.status)?e.status:d.customCode&&""!=d.customCode?400:200:400),b(g,f)}catch(h){b(e.status||400,Worldpay.helpers.JSON.parse('{"error":"'+(e.statusText||"Could not connect to server")+'"}'))}}},e.open(c,a,!0),e.setRequestHeader("Content-type","application/json"),e.send(d);else if(window.XDomainRequest){var f=new XDomainRequest;f.open(c,a),f.onload=function(){var a=f.responseText;try{var d=Worldpay.helpers.JSON.parse(a),e=d.customCode&&""!=d.customCode?{error:{message:d.message,customCode:d.customCode}}:d,g=200;d.token||(g="PUT"==c.toUpperCase()?f.status&&0!=parseInt(f.status)?f.status:d.customCode&&""!=d.customCode?400:200:400),b(g,e)}catch(h){b(400,Worldpay.helpers.JSON.parse('{"error":"Failed to process card, please check your details."}'))}},f.onerror=function(){b(400,Worldpay.helpers.JSON.parse('{"error":"Failed to process card, please check your details."}'))},f.onprogress=function(){},f.ontimeout=function(){b(408,Worldpay.helpers.JSON.parse('{"error":"Processing card timed out, please try again."}'))},setTimeout(function(){f.send(d)},500)}}else if(window.XDomainRequest){var f=new XDomainRequest;f.open(c,a),f.onload=function(){var a=f.responseText;try{var d=Worldpay.helpers.JSON.parse(a),e=d.customCode&&""!=d.customCode?{error:{message:d.message,customCode:d.customCode}}:d,g=200;d.token||(g="PUT"==c.toUpperCase()?f.status&&0!=parseInt(f.status)?f.status:d.customCode&&""!=d.customCode?400:200:400),b(g,e)}catch(h){b(400,Worldpay.helpers.JSON.parse('{"error":"Failed to process card, please check your details."}'))}},f.onerror=function(){b(400,Worldpay.helpers.JSON.parse('{"error":"Failed to process card, please check your details."}'))},f.onprogress=function(){},f.ontimeout=function(){b(408,Worldpay.helpers.JSON.parse('{"error":"Processing card timed out, please try again."}'))},setTimeout(function(){f.send(d)},500)}}catch(g){b(400,Worldpay.helpers.JSON.parse('{"error":"Failed to process card, please check your details."}'))}},Worldpay.helpers.ajax.post=function(a,b,c){Worldpay.helpers.ajax.send(a,b,"POST",c)},Worldpay.helpers.ajax.put=function(a,b,c){Worldpay.helpers.ajax.send(a,b,"PUT",c)},Worldpay.helpers.JSON={},Worldpay.helpers.JSON.stringify=function(a){if(void 0!=JSON&&void 0!=JSON.stringify)return JSON.stringify(a);var b=typeof a;if("object"!==b||null===a)return"string"===b&&(a='"'+a+'"'),String(a);var c,d,e=[],f=a&&a.constructor==Array;for(c in a)d=a[c],b=typeof d,"string"===b?d='"'+d+'"':"object"===b&&null!==d&&(d=Worldpay.helpers.JSON.stringify(d)),e.push((f?"":'"'+c+'":')+String(d));return(f?"[":"{")+String(e)+(f?"]":"}")},Worldpay.helpers.JSON.parse=function(str){return void 0!=JSON&&void 0!=JSON.parse?JSON.parse(str):(""===str&&(str='""'),eval("var p="+str+";"),p)},Worldpay.helpers.Object={},Worldpay.helpers.Object.keys=Object.keys||function(a){var b=Object.prototype.hasOwnProperty,c=!{toString:null}.propertyIsEnumerable("toString"),d=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],e=d.length;return function(a){if("object"!=typeof a&&("function"!=typeof a||null===a))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in a)b.call(a,f)&&h.push(f);if(c)for(g=0;e>g;g++)b.call(a,d[g])&&h.push(d[g]);return h}},Worldpay.apm={},Worldpay.apm.createToken=function(a,b){var c={};c["apm-fields"]={},a&&(a=a);for(var d=0;d<a.length;d++)a[d].getAttribute("data-worldpay")?c[a[d].getAttribute("data-worldpay")]=a[d].value:a[d].getAttribute("data-worldpay-apm")&&(c["apm-fields"][a[d].getAttribute("data-worldpay-apm")]=a[d].value);var e=[];if(c["apm-name"]=c["apm-name"]||"",c["country-code"]=c["country-code"]||"",Worldpay.apm.validateApmName(c["apm-name"])||e.push({apmname:"APM name is not valid"}),Worldpay.apm.validateCountryCode(c["country-code"])||e.push({countrycode:"Country code is not valid"}),e.length)return b(501,Worldpay.helpers.createErrorResponse(e)),!1;var f={reusable:Worldpay.reusable,paymentMethod:{type:"APM",apmName:c["apm-name"],shopperCountryCode:c["country-code"],apmFields:c["apm-fields"]},clientKey:Worldpay.clientKey};c["language-code"]&&(f.shopperLanguageCode=c["language-code"]),Worldpay.helpers.ajax.post(Worldpay.api_path+"tokens",b,Worldpay.helpers.JSON.stringify(f))},Worldpay.apm.validateApmName=function(a){return null===a||""===a?!1:!0},Worldpay.apm.validateCountryCode=function(a){return null===a||""===a?!1:!0},Worldpay.card={},Worldpay.card.updateToken=function(a,b,c){for(var d={},e=0;e<a.length;e++)a[e].getAttribute("data-worldpay")&&(d[a[e].getAttribute("data-worldpay")]=a[e].value);d.cvc=d.cvc||"";var f=[];if(Worldpay.card.validateCVC(d.cvc)||f.push({cvc:"CVC is not valid"}),f.length)return c(501,Worldpay.helpers.createErrorResponse(f)),!1;var g={clientKey:Worldpay.clientKey,cvc:d.cvc};Worldpay.helpers.ajax.put(Worldpay.api_path+"tokens/"+b,c,Worldpay.helpers.JSON.stringify(g))},Worldpay.card.createToken=function(a,b){for(var c={},d=0;d<a.length;d++)a[d].getAttribute("data-worldpay")&&("number"===a[d].getAttribute("data-worldpay")&&(a[d].value=Worldpay.card.stripCardNumber(a[d].value)),c[a[d].getAttribute("data-worldpay")]=a[d].value);c.name=c.name||"",c.number=c.number||"",c["exp-month"]=c["exp-month"]||"",c["exp-year"]=c["exp-year"]||"",c.cvc=c.cvc||"";var e=[];if(Worldpay.card.validateExpiry(c["exp-month"],c["exp-year"])||e.push({expiration:"Card Expiry is not valid"}),"basic"==Worldpay.validationType?Worldpay.card.validateCardNumberBasic(c.number)||e.push({cardnumber:"Card Number is not valid"}):"advanced"==Worldpay.validationType?Worldpay.card.validateCardNumberAdvanced(c.number)||e.push({cardnumber:"Card Number is not valid"}):e.push({other:"Invalid validation type"}),Worldpay.card.validateCardHolderName(c.name)||e.push({nameoncard:"Name on card is not valid"}),Worldpay.card.validateCVC(c.cvc)||e.push({cvc:"CVC is not valid"}),e.length)return b(501,Worldpay.helpers.createErrorResponse(e)),!1;var f={reusable:Worldpay.reusable,paymentMethod:{type:"Card",name:c.name,expiryMonth:c["exp-month"],expiryYear:c["exp-year"],cardNumber:c.number,cvc:c.cvc},clientKey:Worldpay.clientKey};c["language-code"]&&(f.shopperLanguageCode=c["language-code"]),Worldpay.helpers.ajax.post(Worldpay.api_path+"tokens",b,Worldpay.helpers.JSON.stringify(f))},Worldpay.card.reuseToken=function(a,b,c){for(var d={},e=0;e<a.length;e++)a[e].getAttribute("data-worldpay")&&(d[a[e].getAttribute("data-worldpay")]=a[e].value);d.cvc=d.cvc||"",d.token=d.token||c||"";var f=[];if(Worldpay.card.validateCVC(d.cvc)||f.push({cvc:"CVC is not valid"}),""==d.token&&f.push({token:"Token can not be blank"}),f.length)return b(501,Worldpay.helpers.createErrorResponse(f)),!1;var g={clientKey:Worldpay.clientKey,cvc:d.cvc};Worldpay.helpers.ajax.put(Worldpay.api_path+"tokens/"+d.token,b,Worldpay.helpers.JSON.stringify(g))},Worldpay.card.stripCardNumber=function(a){return a=a.replace(/[\s]/g,""),a=a.replace(/[-]/g,"")},Worldpay.card.validateCardNumberBasic=function(a){return null===a?!1:/[^0-9]+/.test(a)?!1:""===a?!1:!0},Worldpay.card.validateCardNumberAdvanced=function(a){if(null===a)return!1;if(""===a)return!1;if(/[^0-9-\s]+/.test(a))return!1;var b=a.split(" ").join("");if(b.length<12||b.length>19)return!1;var c=0,d=0,e=!1;a=a.replace(/\D/g,"");for(var f=a.length-1;f>=0;f--){var g=a.charAt(f),d=parseInt(g,10);e&&(d*=2)>9&&(d-=9),c+=d,e=!e}return c%10==0},Worldpay.card.validateExpiry=function(a,b){if(null===a||null===b||""===a||""===b)return!1;if(/[^0-9]+/.test(a))return!1;if(/[^0-9]+/.test(b))return!1;if(a.length>2)return!1;if(b.length>4||b.length<4)return!1;b=b.toString().slice(-2);var c=(new Date).getMonth()+1,d=(new Date).getFullYear().toString().substr(2);return a=parseInt(a,10),b=parseInt(b,10),isNaN(a)||isNaN(b)?!1:a>12||1>a?!1:b>d||b==d&&a>=c},Worldpay.card.validateCVC=function(a){return""===a?!0:(a||(a=""),-1!==a.indexOf(" ")?!1:/[^0-9]+/.test(a)?!1:!0)},Worldpay.card.validateCardHolderName=function(a){return a||(a=""),a=a.replace(new RegExp(" ","g"),""),/^[a-zA-Z()'-]+$/.test(a)},w.Worldpay=Worldpay}(window);